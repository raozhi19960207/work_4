# AFHelp
这个app是我前年刚毕业时做的一款Android应用，在去年做了下完善（主要是支持了6.0系统特有功能），并且发布到了应用宝、百度手机助手等应用商店。
## 一、使用说明
大白一键求救是一款有短信求救功能的app，使用步骤：  
### 1.设置短信  
![](https://github.com/talonerain/AFHelp/blob/master/screenshots/%E8%AE%BE%E7%BD%AE%E7%9F%AD%E4%BF%A1.jpg)  
### 2.发送短信  
点击“一键求救”按钮发送短信  
![](https://github.com/talonerain/AFHelp/blob/master/screenshots/%E5%8F%91%E9%80%81%E7%9F%AD%E4%BF%A1.jpg)  
### 3.接收短信  
目标手机接收短信内容如下：  
![](https://github.com/talonerain/AFHelp/blob/master/screenshots/%E6%8E%A5%E6%94%B6%E7%9F%AD%E4%BF%A1.PNG)  

## 二、功能模块  
### 1.集成百度定位SDK  
该应用在发送短信时会附带发送当前地理位置，我用的是百度地图定位的sdk，具体使用方法可参照百度官方api文档，不过初次使用问题应该不少，我这里花了很多时间才调通。定位成功后即发送短信，这里要注意下，因为位置可能不是固定的，所以sdk会重复定位，故要判断下，否则会多次重复发送短信，当然也可以改造下app，加个自动发送短信的功能。  
### 2.集成蒲公英反馈SDK  
每个应用都需要用户反馈功能，以此改正不足。我们这个app是单机的，功能又比较简单，就没必要专门弄个服务器来接收用户反馈，只需接入一个反馈sdk即可。这里我试过多个反馈sdk，先是友盟sdk，可称得上是业界鼻祖了，然而当我按照文档接入完成后人家告诉我友盟sdk已经和阿里合并了，不再提供反馈功能，我又转去接阿里百川的sdk，但是文档实在太复杂，我接完后几乎是在app里面嵌入个聊天工具一样，功能也不是很完美，没有聊天气泡提示，况且这也不合我的需要，几经周折发现了蒲公英sdk，提供反馈功能和崩溃日志记录，接入后发现确实不错，基本满足我的需要，缺陷是自定义功能太少，样式和功能几乎都是固定的，不过这是一年前的版本了，现在是否有完善还不知道。  
### 3.界面功能设计  
这个app使用一个activity和多个fragment，由于业务不是很复杂，所以我把所有业务代码都放在activity里面实现，各个fragment也都放到activity里面操纵，具体的可安装apk后实际体验下。我遇到的比较棘手的问题就是权限问题，网络权限、定位权限、通讯录权限、发送短信权限等等，特别是6.0系统改变了授权方式，仿照ios在运行应用时提示用户授权，这里要自己手写代码授权并考虑和以前版本的兼容问题。  
### 4.应用发布  
app做完后想要发布到应用商店，因为以前不熟悉这个流程，所以整整折腾我两天。问题主要是app的签名及加固。国内的几个主流渠道都有自己的签名及加固方式，并强制使用，否则不给上架，因此只能单个去加固，我也试了几个一键加固的方法统统不行，其中使用360的加固工具加固后，应用运行就崩溃，而几个硬件渠道（手机厂商渠道）统统不支持个人开发者的应用上架，唯独小米支持，但我这个又没通过小米的monkey测试。最终，只在这几个应用商店成功上架：应用宝、百度手机助手、91助手、安卓市场。  
## 功能改进  
我稍稍做了下总结，以下问题待改进，期待有朋友相助：  
### 1.框架变更  
谷歌已经推出了databinding，感觉这个是趋势，因此准备把本应用改为mvvm模式。  
### 2.实现电源键发送短信功能  
目前app通过用户点击应用内按钮实现短信发送，而当有紧急情况时点开应用再去点击按钮可能导致求救不及时，因此准备添加多次快速点击电源按钮即发送短信功能。  
### 3.实现地图定位跟踪功能  
求救人的位置很可能是不固定的，因此发送短信时的地理位置就可能会过时，可通过两种方式改进这个问题，一种是定时自动发送定位短信给被求救者，一种是直接通过地图sdk，在发送短信时发送位置链接，被求救者点开链接即可实时获取求救者的地图位置信息。  



